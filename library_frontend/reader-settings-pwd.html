<!DOCTYPE html>
<html lang="en">
<head>
    <title>Library</title>
    <meta charset="utf-8">
    <meta name="description" content="library">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- favicon-->
    <link rel="apple-touch-icon" sizes="180x180" href="favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" href="favicon/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="favicon/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="favicon/manifest.json">
    <link rel="mask-icon" href="favicon/safari-pinned-tab.svg">
    <link rel="shortcut icon" href="favicon/favicon.ico">
    <meta name="msapplication-config" content="favicon/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <!-- ./ favicon-->
    <link rel="stylesheet" href="css/bootstrap.css">
    <link rel="stylesheet" href="css/main.css">
    <style>
        #image-preview {
            border: 1px solid #ccc;
            width: auto;
            height: 280px;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center center;
        }
    </style>
</head>
<body>
<div class="all">
    <!-- header-->
    <div class="header">
        <div class="header-inner">
            <div class="header-logo"><a href="cips.html">Library</a></div>
            <div class="header-icons">
                <div class="search"><a href="#"><i class="icon-search"></i></a></div>
                <div><a href="reader-settings.html"><i class="icon-settings"></i></a></div>
                <div class="burger hidden-lg hidden-md"><a href="#"><span></span><span></span><span></span></a></div>
            </div>
            <div class="header-logged">
                <a href="#">
                    <span class="reader-name">reader</span>
                    <span class="avatar">
            <img class="reader-image" src="" alt="">
          </span>
                </a>
                <a href="login-reader.html"><svg t="1592383404691" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2812" width="28" height="28"><path d="M755.719 962h-487.5c-66.274 0-120-53.726-120-120v-120h49.412v120c0 33.075 37.5 70.587 70.587 70.587h487.5c33.075 0 70.587-37.5 70.587-70.587v-660c0-33.075-37.5-70.587-70.587-70.587h-487.5c-33.075 0-70.587 37.5-70.587 70.587v120h-49.412v-120c0-66.274 53.726-120 120-120h487.5c66.274 0 120 53.726 120 120v660c0 66.274-53.726 120-120 120z" p-id="2813" fill="#d81e06"></path><path d="M513.157 324.737l-162.6 162.5h352.75c16.562 0 30 8.112 30 24.7s-13.45 24.712-30 24.712h-352.75l162.6 162.651c11.7 11.688 19.663 30.7 7.938 42.412s-28.087 11.724-39.813 0l-206.988-206.937c-5.301-5.354-8.574-12.723-8.574-20.856 0-0.011 0-0.022 0-0.034 0-0.649 0-1.248 0.063-1.761s-0.063-1.25-0.063-1.962c0-0.014 0-0.031 0-0.049 0-8.107 3.265-15.453 8.553-20.792l207.010-206.997c11.724-11.724 26.787-11.688 38.487 0s5.075 30.7-6.613 42.413z" p-id="2814" fill="#d81e06"></path></svg></a>

            </div>
        </div>
    </div>
    <!-- ./ header-->
    <!-- search-->
    <div id="search" class="search-form">
        <form action="cips.html">
            <div class="icon-search"></div>
            <input type="text" placeholder="search" value="">
        </form>
    </div>
    <!-- ./ search-->
    <!-- content-->
    <div class="page page-settings">
        <div class="page-nav">
            <div class="page-nav-inner">
                <div class="header-logged">
                    <a href="#">
                        <span class="reader-name">reader</span>
                        <span class="avatar">
              <img class="reader-image" src="" alt="">
            </span>
                    </a>
                </div>
                <ul class="page-nav__list">
                    <li><a href="reader-records.html">我的借阅</a></li>
                    <li><a href="reader-reservations.html">我的预约</a></li>
                </ul>
                <div class="btn-group">
                </div>
                <div class="page-nav-footer"></div>
            </div>
        </div>
        <div class="page-content">
            <div class="settings-form">
                <ul class="settings-form__nav">
                    <li><a href="reader-settings.html">基本信息</a></li>
                    <li class="active"><a href="reader-settings-pwd.html">修改密码</a></li>
                    <li><a href="#">敬请期待</a></li>
                </ul>
                <div class="settings-form__content">
                    <form id="reader-info" class="form-horizontal">
                        <div class="row">
                            <!--第一列-->
                            <div class="col-md-5">
                                <div class="form-group">
                                    <label>旧密码</label>
                                    <input id="old-pwd-input" name="oldPwd" type="password" placeholder="请输入旧密码"
                                           class="form-control">
                                </div>
                                <div class="form-group">
                                    <label>新密码</label>
                                    <input id="new-pwd-input" name="newPwd" type="password" placeholder="请输入新密码"
                                           class="form-control">
                                </div>
                                <div class="form-group">
                                    <label>新密码</label>
                                    <input id="confirm-pwd-input" name="newPwdConfirmed" type="password"
                                           placeholder="再次输入新密码"
                                           class="form-control">
                                </div>
                                <div class="form-group text-center">
                                    <button id="save" type="button" class="btn btn-accent">保存</button>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <!-- ./ content-->
    <!-- footer-->
    <div class="footer">
        <div class="footer-inner">
            <div class="col-left"><a href="">Contact us</a></div>
            <div class="col-center">
                <div class="social-network">
                    <a href="#" target="" data-toggle="modal" data-target="#myModalq" ><svg t="1592380933523" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3104" width="20" height="20"><path d="M946.688 552.96a330.496 330.496 0 0 0-63.04-111.808 190.08 190.08 0 0 0-20.672-81.984A351.232 351.232 0 0 0 512.192 17.856a351.232 351.232 0 0 0-350.784 342.272c-12.8 25.536-19.584 52.48-20.224 80.128a325.696 325.696 0 0 0-63.872 112.832c-16.064 51.136-22.144 105.728-16.64 149.888 6.848 55.168 31.424 94.016 69.568 110.528a118.4 118.4 0 0 0-6.848 40c0 45.888 25.344 86.656 71.36 114.752 40.768 24.896 94.336 38.016 154.816 38.016 60.032 0 116.288-14.4 156.928-39.744 3.52 0 7.168 0.128 10.752 0 40.64 25.344 97.024 39.744 156.992 39.744 60.48 0 113.984-13.12 154.752-38.016 46.08-28.096 71.36-68.864 71.36-114.752 0-13.888-2.24-27.2-6.72-39.872 38.208-16.512 62.72-55.36 69.632-110.656 5.568-44.16-0.512-98.816-16.576-150.016z m-84.864 192a24.576 24.576 0 0 1-7.744 1.28 37.504 37.504 0 0 1-21.248-7.936l-32.128-23.168-0.128 0.256a40.704 40.704 0 0 0-39.808 70.784l28.8 17.472c16.192 9.728 35.456 26.368 35.456 49.856 0 43.392-66.24 77.248-150.72 77.248-49.408 0-95.744-12.224-123.776-32.896l-10.88-7.872-13.44 0.64a232.768 232.768 0 0 1-28.352 0l-13.568-0.768-10.88 8c-28.032 20.608-74.368 32.896-123.776 32.896-84.544 0-150.72-33.856-150.72-77.248 0-23.488 19.328-40.128 35.52-49.92l33.792-20.416-0.192-0.384a40.704 40.704 0 1 0-50.688-63.36l-26.048 18.88a36.864 36.864 0 0 1-21.312 8 23.936 23.936 0 0 1-7.744-1.28c-31.232-10.496-37.312-91.2-12.8-169.344 13.248-42.24 38.592-75.456 57.472-95.808l11.264-12.032-1.408-16.576a115.008 115.008 0 0 1 15.168-63.232l4.864-8.64v-10.88c0-151.744 123.584-275.2 275.392-275.2s275.392 123.456 275.392 275.2v10.24l4.864 8.768c10.496 18.368 15.744 37.632 15.744 57.152 0 2.496-0.128 4.8-0.256 7.36l-1.344 16.384 11.264 12.096c18.624 20.288 43.776 53.184 56.896 95.104 24.448 78.144 18.304 158.848-12.928 169.344z" fill="" p-id="3105"></path></svg></a>
                    <a href="#" target="" data-toggle="modal" data-target="#myModalw"><svg t="1592381059482" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5384" width="20" height="20"><path d="M498.816 345.056c26.336 0 43.936-17.632 43.936-43.904 0-26.56-17.568-43.744-43.936-43.744s-52.832 17.184-52.832 43.744C446.016 327.424 472.48 345.056 498.816 345.056zM253.088 257.408c-26.336 0-52.96 17.184-52.96 43.744 0 26.272 26.624 43.904 52.96 43.904 26.24 0 43.808-17.632 43.808-43.904C296.864 274.592 279.328 257.408 253.088 257.408zM1024 626.112c0-138.88-128.832-257.216-286.976-269.536 0.224-1.728 0.32-3.52-0.064-5.312-31.712-147.84-190.688-259.296-369.824-259.296C164.704 91.968 0 233.12 0 406.624c0 93.088 47.52 176.96 137.568 243.104l-31.392 94.368c-2.016 6.144-0.192 12.896 4.704 17.152 2.976 2.56 6.72 3.904 10.496 3.904 2.432 0 4.896-0.576 7.168-1.696L246.4 704.48l14.528 2.944c36.288 7.456 67.616 13.92 106.208 13.92 11.36 0 22.88-0.512 34.176-1.472 4.576-0.384 8.448-2.688 11.072-6.016 42.496 106.336 159.616 183.104 297.44 183.104 35.296 0 71.04-8.512 103.104-16.544l90.848 49.664c2.4 1.312 5.056 1.984 7.68 1.984 3.584 0 7.168-1.216 10.048-3.552 5.056-4.096 7.136-10.848 5.248-17.024l-23.2-77.152C981.344 772.864 1024 699.328 1024 626.112zM398.592 687.968c-10.4 0.896-20.96 1.344-31.424 1.344-35.328 0-65.216-6.112-99.776-13.248L247.296 672c-3.456-0.736-7.104-0.256-10.272 1.376l-88.288 44.192 22.944-68.928c2.24-6.752-0.224-14.112-6.016-18.176C76.96 568.64 32 493.312 32 406.624c0-155.84 150.336-282.656 335.136-282.656 163.36 0 308 99.392 337.856 231.584-171.296 2.24-309.888 122.656-309.888 270.56 0 21.504 3.264 42.336 8.768 62.432C402.208 688.128 400.448 687.808 398.592 687.968zM875.456 815.552c-5.344 4.032-7.616 10.976-5.696 17.376l15.136 50.336-62.112-33.984c-2.368-1.312-5.024-1.984-7.68-1.984-1.312 0-2.624 0.16-3.904 0.512-33.312 8.416-67.776 17.088-101.344 17.088-155.904 0-282.72-107.136-282.72-238.816 0-131.68 126.816-238.784 282.72-238.784 152.928 0 282.144 109.344 282.144 238.784C992 691.744 950.624 759.04 875.456 815.552zM612.992 511.968c-17.568 0-35.136 17.696-35.136 35.232 0 17.664 17.568 35.104 35.136 35.104 26.4 0 43.84-17.44 43.84-35.104C656.832 529.632 639.392 511.968 612.992 511.968zM806.016 511.968c-17.312 0-34.88 17.696-34.88 35.232 0 17.664 17.568 35.104 34.88 35.104 26.304 0 44.064-17.44 44.064-35.104C850.08 529.632 832.352 511.968 806.016 511.968z" p-id="5385"></path></svg></a>
                    <a href="#" target="" data-toggle="modal" data-target="#myModalt"><svg t="1592381965905" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="6817" width="20" height="20"><path d="M716.8 0a102.4 102.4 0 0 1 102.4 102.4v819.2a102.4 102.4 0 0 1-102.4 102.4H307.2a102.4 102.4 0 0 1-102.4-102.4V102.4a102.4 102.4 0 0 1 102.4-102.4h409.6z m1.664 50.3552h-78.1056v14.0288a38.4 38.4 0 0 1-38.4 38.4H422.4a38.4 38.4 0 0 1-38.4-38.4l-0.0256-14.0288h-78.4384a51.2 51.2 0 0 0-51.0464 47.3856l-0.1536 3.84v820.864a51.2 51.2 0 0 0 47.3856 51.0464l3.84 0.1536h412.9024a51.2 51.2 0 0 0 51.0464-47.3856l0.1536-3.84V101.5808a51.2 51.2 0 0 0-51.2-51.2z" p-id="6818"></path></svg></a>
                </div>
            </div>
            <div class="col-right"><a href="mailto:624297803@qq.com">624297803@qq.com</a></div>
        </div>
    </div>
    <!-- ./footer-->
    <!-- ./ all content-->
</div>
<!-- 模态框（Modal） -->
<div class="modal fade" id="myModalq" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog" style="width: 400px;">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h4 class="modal-title" id="myModalLabel"><font size="6" color="black">QQ</font></h4>
            </div>
            <div class="modal-body">
                <img src="img/qq.jpg" border="2">
            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-dismiss="modal">关闭</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div>

<div class="modal fade" id="myModalw" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog" style="width: 400px;">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h4 class="modal-title" id="myModalLabel1"><font size="6" color="black">微信</font></h4>
            </div>
            <div class="modal-body">
                <img src="img/wx.jpg" border="2">
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-dismiss="modal">关闭</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div>

<div class="modal fade" id="myModalt" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog" style="width: 400px;">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h4 class="modal-title" id="myModalLabel2"><font size="6" color="black">Tel</font></h4>
            </div>
            <div class="modal-body">
                <p>  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    <font  size="4" color="gray"> 18916339782 </font></p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-dismiss="modal">关闭</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div>
<!-- scripts-->
<link href="css/toast.style.css" rel="stylesheet">
<script type="text/javascript" src="js/jquery.min.js"></script>
<script src="js/toast.script.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="js/slick.min.js"></script>
<script src="js/main.min.js"></script>
<script src="js/vue.min.js"></script>
<script src="js/IP.js"></script>
<!-- ./ scripts-->
</body>
<script>
    function failToast(meg)
    {
        $.Toast("修改失败", meg, "error", {
            stack: true,
            position_class: "toast-top-right",
            has_icon: true,
            has_close_btn: true,
            fullscreen: false,
            timeout: 2500,
            sticky: false,
            has_progress: true,
            rtl: false,
        });
    }
    function sucToast()
    {
        $.Toast("修改成功", '请重新登录', "success", {
            stack: true,
            position_class: "toast-top-right",
            has_icon: true,
            has_close_btn: true,
            fullscreen: false,
            timeout: 1000,
            sticky: false,
            has_progress: true,
            rtl: false,
        });
    }
    //根据本地存储的rid获取读者信息
    $.ajax({
        headers: {
            Authorization: 'Bearer ' + window.localStorage.getItem('reader_token')
        },
        url: 'http://' + IP + '/reader/name?rid=' + window.localStorage.getItem('rid'),
        type: "GET",
        success: function (data, textStatus, jqXHR) {
            $(".reader-name").text(data.rname);
            $(".reader-image").attr("src", "http://" + IP + "/images/readers/" + window.localStorage.getItem('rid') + ".jpg")
        },
        error: function (jqXHR, textStatus, errorThrown) {

        }
    });
    //确认上传信息
    $("#save").click(function () {
        //两次输入一致
        if ($("#new-pwd-input").val() == $("#confirm-pwd-input").val()) {
            $.ajax({
                headers: {
                    Authorization: 'Bearer ' + window.localStorage.getItem('reader_token')
                },
                url: "http://" + IP + "/reader/pwd",
                type: "POST",
                data: {
                    rid: window.localStorage.getItem('rid'),
                    oldPwd: $("#old-pwd-input").val(),
                    newPwd: $("#new-pwd-input").val(),
                },
                success: function (data, textStatus, jqXHR) {
                    sucToast();
                    setTimeout(function () {
                        window.location.href = 'login-reader.html';
                    },1000)
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    failToast('原密码错误。');
                    $("#old-pwd-input").val('');
                }
            });
        }
        else {
            // $("#old-pwd-input").val('');
            failToast('两次密码输入不一致。');
            $("#new-pwd-input").val('');
            $("#confirm-pwd-input").val('');
        }

    });

</script>
</html>